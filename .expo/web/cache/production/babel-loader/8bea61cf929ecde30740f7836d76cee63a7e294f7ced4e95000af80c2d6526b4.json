{"ast":null,"code":"'use strict';import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _classPrivateFieldLooseBase from\"@babel/runtime/helpers/classPrivateFieldLooseBase\";import _classPrivateFieldLooseKey from\"@babel/runtime/helpers/classPrivateFieldLooseKey\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{registerEventHandler,unregisterEventHandler}from\"./core.js\";import{shouldBeUseWeb}from\"./PlatformChecker.js\";var SHOULD_BE_USE_WEB=shouldBeUseWeb();function jsListener(eventName,handler){return function(evt){handler(_objectSpread(_objectSpread({},evt.nativeEvent),{},{eventName:eventName}));};}var _viewTags=_classPrivateFieldLooseKey(\"viewTags\");var _registrations=_classPrivateFieldLooseKey(\"registrations\");var WorkletEventHandlerNative=function(){function WorkletEventHandlerNative(worklet,eventNames){_classCallCheck(this,WorkletEventHandlerNative);Object.defineProperty(this,_viewTags,{writable:true,value:void 0});Object.defineProperty(this,_registrations,{writable:true,value:void 0});this.worklet=worklet;this.eventNames=eventNames;_classPrivateFieldLooseBase(this,_viewTags)[_viewTags]=new Set();_classPrivateFieldLooseBase(this,_registrations)[_registrations]=new Map();}return _createClass(WorkletEventHandlerNative,[{key:\"updateEventHandler\",value:function updateEventHandler(newWorklet,newEvents){var _this=this;this.worklet=newWorklet;this.eventNames=newEvents;_classPrivateFieldLooseBase(this,_registrations)[_registrations].forEach(function(registrationIDs){registrationIDs.forEach(function(id){return unregisterEventHandler(id);});});Array.from(_classPrivateFieldLooseBase(this,_viewTags)[_viewTags]).forEach(function(tag){var newRegistrations=_this.eventNames.map(function(eventName){return registerEventHandler(_this.worklet,eventName,tag);});_classPrivateFieldLooseBase(_this,_registrations)[_registrations].set(tag,newRegistrations);});}},{key:\"registerForEvents\",value:function registerForEvents(viewTag,fallbackEventName){var _this2=this;_classPrivateFieldLooseBase(this,_viewTags)[_viewTags].add(viewTag);var newRegistrations=this.eventNames.map(function(eventName){return registerEventHandler(_this2.worklet,eventName,viewTag);});_classPrivateFieldLooseBase(this,_registrations)[_registrations].set(viewTag,newRegistrations);if(this.eventNames.length===0&&fallbackEventName){var newRegistration=registerEventHandler(this.worklet,fallbackEventName,viewTag);_classPrivateFieldLooseBase(this,_registrations)[_registrations].set(viewTag,[newRegistration]);}}},{key:\"unregisterFromEvents\",value:function unregisterFromEvents(viewTag){var _classPrivateFieldLoo;_classPrivateFieldLooseBase(this,_viewTags)[_viewTags].delete(viewTag);(_classPrivateFieldLoo=_classPrivateFieldLooseBase(this,_registrations)[_registrations].get(viewTag))==null?void 0:_classPrivateFieldLoo.forEach(function(id){unregisterEventHandler(id);});_classPrivateFieldLooseBase(this,_registrations)[_registrations].delete(viewTag);}}]);}();var WorkletEventHandlerWeb=function(){function WorkletEventHandlerWeb(worklet){var eventNames=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,WorkletEventHandlerWeb);this.worklet=worklet;this.eventNames=eventNames;this.listeners={};this.setupWebListeners();}return _createClass(WorkletEventHandlerWeb,[{key:\"setupWebListeners\",value:function setupWebListeners(){var _this3=this;this.listeners={};this.eventNames.forEach(function(eventName){_this3.listeners[eventName]=jsListener(eventName,_this3.worklet);});}},{key:\"updateEventHandler\",value:function updateEventHandler(newWorklet,newEvents){this.worklet=newWorklet;this.eventNames=newEvents;this.setupWebListeners();}},{key:\"registerForEvents\",value:function registerForEvents(_viewTag,_fallbackEventName){}},{key:\"unregisterFromEvents\",value:function unregisterFromEvents(_viewTag){}}]);}();export var WorkletEventHandler=SHOULD_BE_USE_WEB?WorkletEventHandlerWeb:WorkletEventHandlerNative;","map":{"version":3,"names":["_classCallCheck","_createClass","_classPrivateFieldLooseBase","_classPrivateFieldLooseKey","_defineProperty","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","registerEventHandler","unregisterEventHandler","shouldBeUseWeb","SHOULD_BE_USE_WEB","jsListener","eventName","handler","evt","nativeEvent","_viewTags","_registrations","WorkletEventHandlerNative","worklet","eventNames","writable","value","Set","Map","key","updateEventHandler","newWorklet","newEvents","_this","registrationIDs","id","Array","from","tag","newRegistrations","map","set","registerForEvents","viewTag","fallbackEventName","_this2","add","newRegistration","unregisterFromEvents","_classPrivateFieldLoo","delete","get","WorkletEventHandlerWeb","undefined","listeners","setupWebListeners","_this3","_viewTag","_fallbackEventName","WorkletEventHandler"],"sources":["C:\\Users\\Jorn\\Documents\\hitster\\node_modules\\react-native-reanimated\\src\\WorkletEventHandler.ts"],"sourcesContent":["'use strict';\nimport type { NativeSyntheticEvent } from 'react-native';\n\nimport { registerEventHandler, unregisterEventHandler } from './core';\nimport type {\n  EventPayload,\n  IWorkletEventHandler,\n  ReanimatedEvent,\n} from './hook/commonTypes';\nimport { shouldBeUseWeb } from './PlatformChecker';\n\nconst SHOULD_BE_USE_WEB = shouldBeUseWeb();\n\ntype JSEvent<Event extends object> = NativeSyntheticEvent<EventPayload<Event>>;\n\n// In JS implementation (e.g. for web) we don't use Reanimated's\n// event emitter, therefore we have to handle here\n// the event that came from React Native and convert it.\nfunction jsListener<Event extends object>(\n  eventName: string,\n  handler: (event: ReanimatedEvent<Event>) => void\n) {\n  return (evt: JSEvent<Event>) => {\n    handler({ ...evt.nativeEvent, eventName } as ReanimatedEvent<Event>);\n  };\n}\n\nclass WorkletEventHandlerNative<Event extends object>\n  implements IWorkletEventHandler<Event>\n{\n  eventNames: string[];\n  worklet: (event: ReanimatedEvent<Event>) => void;\n  #viewTags: Set<number>;\n  #registrations: Map<number, number[]>; // keys are viewTags, values are arrays of registration ID's for each viewTag\n  constructor(\n    worklet: (event: ReanimatedEvent<Event>) => void,\n    eventNames: string[]\n  ) {\n    this.worklet = worklet;\n    this.eventNames = eventNames;\n    this.#viewTags = new Set<number>();\n    this.#registrations = new Map<number, number[]>();\n  }\n\n  updateEventHandler(\n    newWorklet: (event: ReanimatedEvent<Event>) => void,\n    newEvents: string[]\n  ): void {\n    // Update worklet and event names\n    this.worklet = newWorklet;\n    this.eventNames = newEvents;\n\n    // Detach all events\n    this.#registrations.forEach((registrationIDs) => {\n      registrationIDs.forEach((id) => unregisterEventHandler(id));\n      // No need to remove registrationIDs from map, since it gets overwritten when attaching\n    });\n\n    // Attach new events with new worklet\n    Array.from(this.#viewTags).forEach((tag) => {\n      const newRegistrations = this.eventNames.map((eventName) =>\n        registerEventHandler(this.worklet, eventName, tag)\n      );\n      this.#registrations.set(tag, newRegistrations);\n    });\n  }\n\n  registerForEvents(viewTag: number, fallbackEventName?: string): void {\n    this.#viewTags.add(viewTag);\n\n    const newRegistrations = this.eventNames.map((eventName) =>\n      registerEventHandler(this.worklet, eventName, viewTag)\n    );\n    this.#registrations.set(viewTag, newRegistrations);\n\n    if (this.eventNames.length === 0 && fallbackEventName) {\n      const newRegistration = registerEventHandler(\n        this.worklet,\n        fallbackEventName,\n        viewTag\n      );\n      this.#registrations.set(viewTag, [newRegistration]);\n    }\n  }\n\n  unregisterFromEvents(viewTag: number): void {\n    this.#viewTags.delete(viewTag);\n    this.#registrations.get(viewTag)?.forEach((id) => {\n      unregisterEventHandler(id);\n    });\n    this.#registrations.delete(viewTag);\n  }\n}\n\nclass WorkletEventHandlerWeb<Event extends object>\n  implements IWorkletEventHandler<Event>\n{\n  eventNames: string[];\n  listeners:\n    | Record<string, (event: ReanimatedEvent<ReanimatedEvent<Event>>) => void>\n    | Record<string, (event: JSEvent<Event>) => void>;\n\n  worklet: (event: ReanimatedEvent<Event>) => void;\n\n  constructor(\n    worklet: (event: ReanimatedEvent<Event>) => void,\n    eventNames: string[] = []\n  ) {\n    this.worklet = worklet;\n    this.eventNames = eventNames;\n    this.listeners = {};\n    this.setupWebListeners();\n  }\n\n  setupWebListeners() {\n    this.listeners = {};\n    this.eventNames.forEach((eventName) => {\n      this.listeners[eventName] = jsListener(eventName, this.worklet);\n    });\n  }\n\n  updateEventHandler(\n    newWorklet: (event: ReanimatedEvent<Event>) => void,\n    newEvents: string[]\n  ): void {\n    // Update worklet and event names\n    this.worklet = newWorklet;\n    this.eventNames = newEvents;\n    this.setupWebListeners();\n  }\n\n  registerForEvents(_viewTag: number, _fallbackEventName?: string): void {\n    // noop\n  }\n\n  unregisterFromEvents(_viewTag: number): void {\n    // noop\n  }\n}\n\nexport const WorkletEventHandler = SHOULD_BE_USE_WEB\n  ? WorkletEventHandlerWeb\n  : WorkletEventHandlerNative;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}